{
	"name": "AggreagateDataFlow",
	"properties": {
		"description": "Means it is used to convert the columns of data into Aggregated Data into different forms like max min count avg sum ..... ",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DelimitedText3",
						"type": "DatasetReference"
					},
					"name": "AggregateDataSource",
					"description": "Means it is used to convert the columns of data into Aggregated Data into different forms like max min count avg sum ..... "
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DelimitedText6",
						"type": "DatasetReference"
					},
					"name": "sink1",
					"rejectedDataLinkedService": {
						"referenceName": "AzureBlobStorage1",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "CastingAggreagatedData"
				},
				{
					"name": "AggreagtingData",
					"description": "Add aggregate columns"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Country as string,",
				"          Features as string,",
				"          Region as string,",
				"          {1980} as string,",
				"          {1981} as string,",
				"          {1982} as string,",
				"          {1983} as string,",
				"          {1984} as string,",
				"          {1985} as string,",
				"          {1986} as string,",
				"          {1987} as string,",
				"          {1988} as string,",
				"          {1989} as string,",
				"          {1990} as string,",
				"          {1991} as string,",
				"          {1992} as string,",
				"          {1993} as string,",
				"          {1994} as string,",
				"          {1995} as string,",
				"          {1996} as string,",
				"          {1997} as string,",
				"          {1998} as string,",
				"          {1999} as string,",
				"          {2000} as string,",
				"          {2001} as string,",
				"          {2002} as string,",
				"          {2003} as string,",
				"          {2004} as string,",
				"          {2005} as string,",
				"          {2006} as string,",
				"          {2007} as string,",
				"          {2008} as string,",
				"          {2009} as string,",
				"          {2010} as string,",
				"          {2011} as string,",
				"          {2012} as string,",
				"          {2013} as string,",
				"          {2014} as string,",
				"          {2015} as string,",
				"          {2016} as string,",
				"          {2017} as string,",
				"          {2018} as string,",
				"          {2019} as string,",
				"          {2020} as string,",
				"          {2021} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> AggregateDataSource",
				"AggregateDataSource cast(output(",
				"          Country as string,",
				"          Features as string,",
				"          Region as string,",
				"          {1980} as double,",
				"          {1981} as double,",
				"          {1982} as double,",
				"          {1983} as double,",
				"          {1984} as double,",
				"          {1985} as double,",
				"          {1986} as double,",
				"          {1987} as double,",
				"          {1988} as double,",
				"          {1989} as double,",
				"          {1990} as double,",
				"          {1991} as double,",
				"          {1992} as double,",
				"          {1993} as double,",
				"          {1994} as double,",
				"          {1995} as double,",
				"          {1996} as double,",
				"          {1997} as double,",
				"          {1998} as double,",
				"          {1999} as double,",
				"          {2000} as double,",
				"          {2001} as double,",
				"          {2002} as double,",
				"          {2003} as double,",
				"          {2004} as double,",
				"          {2005} as double,",
				"          {2006} as double,",
				"          {2007} as double,",
				"          {2008} as double,",
				"          {2009} as double,",
				"          {2010} as double,",
				"          {2011} as double,",
				"          {2012} as double,",
				"          {2013} as double,",
				"          {2014} as double,",
				"          {2015} as double,",
				"          {2016} as double,",
				"          {2017} as double,",
				"          {2018} as double,",
				"          {2019} as double,",
				"          {2020} as double,",
				"          {2021} as double",
				"     ),",
				"     errors: true) ~> CastingAggreagatedData",
				"CastingAggreagatedData aggregate(groupBy(Country),",
				"     MaxOf1980 = max({1980}),",
				"          MinOf1981 = min({1981}),",
				"          CountOf1982 = count({1982}),",
				"          SumOf1983 = sum({1983}),",
				"          AverageOf1984 = avg({1984}),",
				"          VarianceOf1985 = variance({1985})) ~> AggreagtingData",
				"AggreagtingData derive(Country = toString(Country),",
				"          MaxOf1980 = toDouble(MaxOf1980),",
				"          MinOf1981 = toDouble(MinOf1981),",
				"          CountOf1982 = toDouble(CountOf1982),",
				"          SumOf1983 = toDouble(SumOf1983),",
				"          AverageOf1984 = toDouble(AverageOf1984),",
				"          VarianceOf1985 = toDouble(VarianceOf1985)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: true,",
				"     partitionFileNames:['AggregateSinkData'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          Country,",
				"          MaxOf1980,",
				"          MinOf1981,",
				"          CountOf1982,",
				"          SumOf1983,",
				"          AverageOf1984,",
				"          VarianceOf1985",
				"     ),",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}